---
title: Search
noProse: true
---

import Link from 'next/link'
import { useState, useEffect } from 'react'
import mdxData from '../data/mdx'
import cleanForSearch from '../utils/cleanForSearch'

export function Search() {
    const [text, setText] = useState('')
    const [posts, setPosts] = useState([])
    useEffect(() => {
        if(text === '') {
            setPosts(
                mdxData.sort(() => Math.random() - 0.5)
            )
        } else {
            setPosts(
                mdxData.filter(post => post.searchContents.includes(cleanForSearch(text)))
            )
        }
    }, [text])
    return (
        <>
            <div className="space-y-1 mb-10">
                <label htmlFor="search" className="font-medium text-gray-400 block">Search all posts</label>
                <input
                    type="text"
                    id="search"
                    className="block border-2 border-gray-200 w-full rounded-lg focus:border-rose-400 focus:ring-0 transition-colors duration-150"
                    autoFocus
                    value={text}
                    onChange={e => setText(e.target.value)}
                />
            </div>
            <div className="space-y-4">
                {posts.map(post => (
                    <Link href={`/${post.slug}`} key={post.slug}>
                        <a className="block">
                            <div className="bg-gray-50 px-3 py-2 border border-gray-200 rounded-lg text-gray-600 hover:bg-gray-200 hover:text-gray-900 hover:border-gray-300 transition-colors">
                                <p className="font-medium">{post.title}</p>
                            </div>
                        </a>
                    </Link>
                ))}
            </div>
        </>
    )
}

<Search />
