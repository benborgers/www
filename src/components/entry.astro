---
import type { CollectionEntry } from "astro:content";
import Prose from "./prose.astro";

interface Props {
  coverImage?: string;
  title?: string;
  entry: CollectionEntry<"posts"> | CollectionEntry<"pages">;
  preview?: boolean;
}

const { entry, ...props } = Astro.props;

const coverImage =
  props.coverImage ??
  (entry.collection === "posts" ? entry.data.cover_image : undefined);

const title =
  props.title ?? (entry.collection === "posts" ? entry.data.title : undefined);

const date = entry.collection === "posts" ? entry.data.date : undefined;

const hasFrontmatter = coverImage || title || date;

const { Content } = await entry.render();
---

<div class="max-sm:mt-4"></div>

{
  entry.collection === "posts" && entry.data.draft && (
    <p class="mb-10 bg-brand-yellow-light text-brand-red border border-brand-red px-2 py-0.5 font-medium max-w-max mx-auto">
      youâ€™re reading a draft post
    </p>
  )
}

{
  hasFrontmatter && (
    <>
      {coverImage && <img src={coverImage} alt="" class="max-h-54 mx-auto" />}

      {title && (
        <h1
          class:list={[
            "text-gray-950 text-3xl sm:text-4xl font-h1 font-bold uppercase text-center text-balance",
            coverImage && "mt-12",
          ]}
        >
          {title}
        </h1>
      )}

      {date && (
        <time class="block mt-2 text-sm font-medium text-gray-500 text-center">
          {date.toLocaleString("en-US", {
            timeZone: "UTC",
            month: "long",
            day: "numeric",
            year: "numeric",
          })}
        </time>
      )}
    </>
  )
}

<div class:list={[hasFrontmatter ? "mt-10" : "mt-2"]}>
  <Prose>
    <Content />
  </Prose>
</div>
