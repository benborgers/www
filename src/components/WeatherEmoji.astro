---
const emojis = {
    '⛈️': ['thunderstorm'],
    '🌤': ['mostly sunny', 'mostly clear'],
    '⛅': ['partly sunny', 'partly cloudy'],
    '☁️': ['cloud'],
    '🌧️': ['rain'],
    '🌨️': [],
    '☀️': ['sun', 'clear'],
    '❄️': ['snow'],
    '🌩️': [],
    '🌫': ['fog', 'haze']
}

const res = await fetch('https://api.weather.gov/gridpoints/BOX/64,79/forecast')
const json = await res.json()

const fullPhrase = json.properties.periods[0].shortForecast.toLowerCase()
// For matching, we remove the forecast for later (e.g. "mostly sunny then scattered showers and thunderstorms").
const phraseForMatching = fullPhrase.replace(/then .*/, '').trim()


let selectedEmoji
for(const emoji in emojis) {
    if(selectedEmoji) break

    const matchWords = emojis[emoji]
    matchWords.forEach(word => {
        if(phraseForMatching.includes(word)) {
            selectedEmoji = emoji
        }
    })
}

if(! selectedEmoji) {
    selectedEmoji = '🏙'
}
---

<img
    src={`https://emojicdn.elk.sh/${selectedEmoji}`}
    title={`Currently: ${fullPhrase}`}
    class="inline-block w-6 md:w-9 h-auto transform -translate-y-1 mx-0.5"
/>
